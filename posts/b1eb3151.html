<!DOCTYPE html><html lang="zh-CN" color-mode="light"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no"><meta http-equiv="X-UA-Compatible" content="ie=edge"><title>现代游戏引擎 - 游戏引擎的动画技术基础（八） - 樱白</title><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"><meta name="google" content="notranslate"><meta name="google-site-verification" content="eQV1-bjl_nNjXCj2YhmaG3IHeUK9wO34JUX--01e0yI"><meta name="msvalidate.01" content="81DEE48B3A7B549DEC6C5C66F0BB05C2"><meta name="google-adsense-account" content="ca-pub-9139831305743788"><meta name="keywords" content="Cherry,White,CherryWhite,博客,个人成长, games104,游戏引擎,动画"><meta name="description" content="动画技术简介人类一直在试图代表运动中的物体壁画、陶瓷、..."><meta name="author" content="樱白 - Cherry White"><link rel="icon" href="/images/icons/favicon-16x16.ico" type="image/png" sizes="16x16"><link rel="icon" href="/images/icons/favicon-32x32.ico" type="image/png" sizes="32x32"><link rel="apple-touch-icon" href="/images/icons/apple-touch-icon.jpg" sizes="180x180"><meta rel="mask-icon" href="/images/icons/stun-logo.svg" color="#333333"><meta rel="msapplication-TileImage" content="/images/icons/favicon-128x128.ico"><meta rel="msapplication-TileColor" content="#000000"><link rel="canonical" href="https://cherry-white.github.io/posts/b1eb3151.html"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/lib/iconfont/iconfont.css"><link rel="stylesheet" href="/lib/fancybox/fancybox.css"><link rel="stylesheet" href="/lib/highlight/a11y-dark.css"><script>var CONFIG=window.CONFIG||{},ZHAOO=window.ZHAOO||{},CONFIG={isHome:!1,fancybox:!0,pjax:!1,loading:{gif:"/images/theme/loading.gif",lottie:""},lazyload:{enable:!0,only_post:"false",loading:{gif:"/images/theme/loading.gif",lottie:""}},donate:{enable:!0,alipay:"/images/pay/alipay.png",wechat:"/images/pay/wechat.jpg"},galleries:{enable:!0},fab:{enable:!0,always_show:!1},carrier:{enable:!0},daovoice:{enable:!1},preview:{background:{default:"",api:"https://api.mtyqx.cn/api/random.php"},motto:{default:"我在开了灯的床头下，想问问自己的心啊。",typing:!0,api:"https://v2.jinrishici.com/one.json",data_contents:'["data","content"]'}},qrcode:{enable:!0,type:"url",image:"https://pic.izhaoo.com/weapp-code.jpg"},toc:{enable:!0},scrollbar:{type:"normal"},notification:{enable:!1,delay:4500,list:"",page_white_list:"",page_black_list:""},search:{enable:!0,path:"search.xml"}}</script><meta name="generator" content="Hexo 7.3.0"><style>mjx-container[jax=SVG]{direction:ltr}mjx-container[jax=SVG]>svg{overflow:visible}mjx-container[jax=SVG][display=true]{display:block;text-align:center;margin:1em 0}mjx-container[jax=SVG][justify=left]{text-align:left}mjx-container[jax=SVG][justify=right]{text-align:right}g[data-mml-node=merror]>g{fill:red;stroke:red}g[data-mml-node=merror]>rect[data-background]{fill:#ff0;stroke:none}g[data-mml-node=mtable]>line[data-line]{stroke-width:70px;fill:none}g[data-mml-node=mtable]>rect[data-frame]{stroke-width:70px;fill:none}g[data-mml-node=mtable]>.mjx-dashed{stroke-dasharray:140}g[data-mml-node=mtable]>.mjx-dotted{stroke-linecap:round;stroke-dasharray:0,140}g[data-mml-node=mtable]>svg{overflow:visible}[jax=SVG] mjx-tool{display:inline-block;position:relative;width:0;height:0}[jax=SVG] mjx-tool>mjx-tip{position:absolute;top:0;left:0}mjx-tool>mjx-tip{display:inline-block;padding:.2em;border:1px solid #888;font-size:70%;background-color:#f8f8f8;color:#000;box-shadow:2px 2px 5px #aaa}g[data-mml-node=maction][data-toggle]{cursor:pointer}mjx-status{display:block;position:fixed;left:1em;bottom:1em;min-width:25%;padding:.2em .4em;border:1px solid #888;font-size:90%;background-color:#f8f8f8;color:#000}foreignObject[data-mjx-xml]{font-family:initial;line-height:normal;overflow:visible}.MathJax path{stroke-width:3}mjx-container[display=true]{overflow:auto hidden}mjx-container[display=true]+br{display:none}</style><style>.github-emoji{position:relative;display:inline-block;width:1.2em;min-height:1.2em;overflow:hidden;vertical-align:top;color:transparent}.github-emoji>span{position:relative;z-index:10}.github-emoji .fancybox,.github-emoji img{margin:0!important;padding:0!important;border:none!important;outline:0!important;text-decoration:none!important;user-select:none!important;cursor:auto!important}.github-emoji img{height:1.2em!important;width:1.2em!important;position:absolute!important;left:50%!important;top:50%!important;transform:translate(-50%,-50%)!important;user-select:none!important;cursor:auto!important}.github-emoji-fallback{color:inherit}.github-emoji-fallback img{opacity:0!important}</style></head><body class="lock-screen"><div class="loading" id="loading"></div><nav class="navbar"><div class="left"><i class="iconfont iconhome j-navbar-back-home"></i> <i class="iconfont iconqrcode j-navbar-qrcode"></i> <i class="iconfont iconmoono" id="color-toggle" color-toggle="light"></i> <i class="iconfont iconsearch j-navbar-search"></i></div><div class="center">现代游戏引擎 - 游戏引擎的动画技术基础（八）</div><div class="right"><i class="iconfont iconmenu j-navbar-menu"></i></div><div id="qrcode-navbar"></div></nav><nav class="menu"><div class="menu-container"><div class="menu-close"><i class="iconfont iconbaseline-close-px"></i></div><ul class="menu-content"><li class="menu-item"><a href="/" class="underline">首页</a></li><li class="menu-item"><a href="javascript:toRandomPost()" rel="external nofollow noreferrer" class="underline">随机</a></li><li class="menu-item"><a href="/galleries/" class="underline">画廊</a></li><li class="menu-item"><a href="/archives/" class="underline">归档</a></li><li class="menu-item"><a href="/tags/" class="underline">标签</a></li><li class="menu-item"><a href="/categories/" class="underline">分类</a></li><li class="menu-item"><a href="/about/" class="underline">关于</a></li></ul><div class="menu-copyright"><p>Powered by <a target="_blank" href="https://hexo.io" rel="external nofollow noreferrer">Hexo</a> | Theme - <a target="_blank" href="https://github.com/izhaoo/hexo-theme-zhaoo" rel="external nofollow noreferrer">zhaoo</a></p><p>Cherry White .All Rights Reserved Copyright © 2021</p></div></div></nav><main id="main"><div class="article-wrap"><div class="row container"><div class="col-xl-3"></div><div class="col-xl-6"><article class="article"><div class="wrap"><section class="head"><img   class="lazyload" data-original="/images/background/Basics-Animation-Technology.jpg" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg=="  draggable="false"><div class="head-mask"><h1 class="head-title">现代游戏引擎 - 游戏引擎的动画技术基础（八）</h1><div class="head-info"><span class="post-info-item"><i class="iconfont iconcalendar"></i>十月 09, 2022</span> <span class="post-info-item"><i class="iconfont iconfont-size"></i>4817</span></div></div></section><section class="main"><section class="content"><h2 id="动画技术简介"><a href="#动画技术简介" class="headerlink" title="动画技术简介"></a>动画技术简介</h2><p>人类一直在试图代表运动中的物体<br><img   class="lazyload" data-original="/images/article/Games104/08/Games104_08_01.png" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==" ><span class="image-caption">壁画、陶瓷、神庙</span></p><p>序列帧和视觉残留（1/24 秒：翻页书、西洋镜）<br><img   class="lazyload" data-original="/images/article/Games104/08/Games104_08_02.png" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==" ><span class="image-caption">视觉残留</span></p><h3 id="电影中的动画技术发展"><a href="#电影中的动画技术发展" class="headerlink" title="电影中的动画技术发展"></a>电影中的动画技术发展</h3><ul><li>Zafari（2018）第一部用游戏引擎（Unreal）渲染出来的动画短片</li><li>手绘</li><li>骨骼动画，K帧</li><li>动作捕捉</li></ul><p><img   class="lazyload" data-original="/images/article/Games104/08/Games104_08_03.png" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==" ><span class="image-caption">电影动画技术</span></p><h3 id="游戏中的动画技术发展"><a href="#游戏中的动画技术发展" class="headerlink" title="游戏中的动画技术发展"></a>游戏中的动画技术发展</h3><ul><li>序列帧动画（Pac-Man（1980）、波斯王子（1989）、Doom（1993））</li><li>骨骼动画</li><li>蒙皮动画</li><li>物理动画</li></ul><p><img   class="lazyload" data-original="/images/article/Games104/08/Games104_08_04.png" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==" ><span class="image-caption">游戏中的动画技术01</span><br><img   class="lazyload" data-original="/images/article/Games104/08/Games104_08_05.png" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==" ><span class="image-caption">游戏中的动画技术02</span></p><h3 id="游戏动画挑战"><a href="#游戏动画挑战" class="headerlink" title="游戏动画挑战"></a>游戏动画挑战</h3><ol><li>要跟用户进行很多的互动动画（要和其他玩法系统协作、适配各种复杂环境）</li><li>实时的（要在1/30秒完成）</li><li>真实感的要求（表情动画、布娃娃系统、运动匹配系统（Motion Matching））</li></ol><p><img   class="lazyload" data-original="/images/article/Games104/08/Games104_08_06.png" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==" ><span class="image-caption">游戏动画的挑战01</span><br><img   class="lazyload" data-original="/images/article/Games104/08/Games104_08_07.png" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==" ><span class="image-caption">游戏动画的挑战02</span><br><img   class="lazyload" data-original="/images/article/Games104/08/Games104_08_08.png" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==" ><span class="image-caption">游戏动画的挑战03</span></p><h2 id="2D游戏动画技术"><a href="#2D游戏动画技术" class="headerlink" title="2D游戏动画技术"></a>2D游戏动画技术</h2><p>Sprite animation：通过多张图片连续播放获得的近似动画效果，早年红白机小霸王上的游戏大多此原理<br><img   class="lazyload" data-original="/images/article/Games104/08/Games104_08_09.png" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==" ><span class="image-caption">2D序列帧动画</span></p><p>Sprite-like animation：在前者基础上利用多个视角相机进行拍摄获得的更全面的图片信息，从而可以实现模拟3D的效果（Doom）<br><img   class="lazyload" data-original="/images/article/Games104/08/Games104_08_10.png" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==" ><span class="image-caption">2D模拟3D</span></p><p>根据角色的方向，播放指定的动画序列以达到模拟3D动画的效果。这种处理方式也可以用来模拟特效<br><img   class="lazyload" data-original="/images/article/Games104/08/Games104_08_11.png" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==" ><span class="image-caption">2D特效</span></p><p>Lived2D：是一种2D动画生成技术，处理非常简单。其核心思想是将动画对象进行拆分，对图元局部进行Transform以及spine变换以达到模拟局部动画效果。<br><img   class="lazyload" data-original="/images/article/Games104/08/Games104_08_12.png" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==" ><span class="image-caption">Lived2D</span></p><h2 id="3D游戏动画技术"><a href="#3D游戏动画技术" class="headerlink" title="3D游戏动画技术"></a>3D游戏动画技术</h2><h3 id="自由度"><a href="#自由度" class="headerlink" title="自由度"></a>自由度</h3><p>自由度（Degrees of Freedom）：系统对象可变化的基础维度。通常三维空间的物体自由度为6：三个维度上的偏移和三个维度上的旋转。<br><img   class="lazyload" data-original="/images/article/Games104/08/Games104_08_13.png" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==" ><span class="image-caption">DoF</span></p><h3 id="刚性层次动画"><a href="#刚性层次动画" class="headerlink" title="刚性层次动画"></a>刚性层次动画</h3><p>最基础的3D角色动画，就是有层次的（如树状）的刚体的运动，形式类似皮影戏和上面的Live2D。这种方法的问题是刚体间移动旋转时可能会出现缺缝。<br><img   class="lazyload" data-original="/images/article/Games104/08/Games104_08_14.png" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==" ><span class="image-caption">刚性层次动画</span></p><h3 id="顶点动画"><a href="#顶点动画" class="headerlink" title="顶点动画"></a>顶点动画</h3><p>如旗帜、水流的动画效果用刚体难以解决，所以使用3DoFs的顶点动画，计算每一帧下每个顶点的空间位置的变化，<br>一般存成两个texture，第一张的x轴是所有顶点的序号，y轴是帧的数量，位置（x, y）则是某顶点在某帧下空间位置变化的offset；<br>第二张图是记录顶点的法向量，因为随着位置的变化，法向也会变化。这两张图都会利用物理引擎先预计算保存。缺点是数据量会很大。<br><img   class="lazyload" data-original="/images/article/Games104/08/Games104_08_15.png" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==" ><span class="image-caption">顶点动画</span></p><h3 id="Morph-Target-Animation"><a href="#Morph-Target-Animation" class="headerlink" title="Morph Target Animation"></a>Morph Target Animation</h3><p>顶点动画的一种变型，不同的是顶点影响权重。通常用于表情动画，对两个key frame进行插值。<br><img   class="lazyload" data-original="/images/article/Games104/08/Games104_08_16.png" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==" ><span class="image-caption">顶点动画</span></p><h3 id="2D-3D-蒙皮动画"><a href="#2D-3D-蒙皮动画" class="headerlink" title="2D & 3D 蒙皮动画"></a>2D &amp; 3D 蒙皮动画</h3><p>3D角色是动画通常是通过骨骼来驱动的，骨骼所影响的皮肤通常不会的静态的，Mesh会随着骨骼的运动而变化。处理这种问题的技术称为蒙皮骨骼动画。<br><img   class="lazyload" data-original="/images/article/Games104/08/Games104_08_17.png" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==" ><span class="image-caption">3D蒙皮动画</span></p><p>2D也可以使用同样的原理进行处理<br><img   class="lazyload" data-original="/images/article/Games104/08/Games104_08_18.png" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==" ><span class="image-caption">2D蒙皮动画</span></p><h3 id="Physics-based-Animation"><a href="#Physics-based-Animation" class="headerlink" title="Physics-based Animation"></a>Physics-based Animation</h3><p>基于物理的动画，常见于三个方面：Ragdoll，即人从高空坠地时的一些动画，往往部分由艺术家设计实现，部分还需考虑物理原理（自由落体以及坠地瞬间）；<br>衣料的动画；Inverse Kinematics（IK）反向运动学，比如攀爬时如何让这个抓取过程更合理。<br><img   class="lazyload" data-original="/images/article/Games104/08/Games104_08_19.png" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==" ><span class="image-caption">基于物理的动画</span></p><h3 id="Animation-Content-Creation"><a href="#Animation-Content-Creation" class="headerlink" title="Animation Content Creation"></a>Animation Content Creation</h3><ul><li>在专业软件中通过key frame来插值处理</li><li>动捕技术</li></ul><p><img   class="lazyload" data-original="/images/article/Games104/08/Games104_08_20.png" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==" ><span class="image-caption">动画制作方式</span></p><h2 id="蒙皮动画实现"><a href="#蒙皮动画实现" class="headerlink" title="蒙皮动画实现"></a>蒙皮动画实现</h2><h3 id="Mesh如何运动"><a href="#Mesh如何运动" class="headerlink" title="Mesh如何运动"></a>Mesh如何运动</h3><ol><li>为一个Pos创建Mesh</li><li>为Mesh绑定骨骼（骨骼影响哪些顶点）</li><li>设置骨骼的影响权重</li><li>将骨架设置为所需姿势的动画</li><li>通过骨架和蒙皮权重设置蒙皮顶点的动画</li></ol><p>看似简单，但如果顶点的权重设置不合理，模型一动起来可能就炸了。<br><img   class="lazyload" data-original="/images/article/Games104/08/Games104_08_21.png" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==" ><span class="image-caption">Mesh如何运动</span></p><h3 id="坐标系"><a href="#坐标系" class="headerlink" title="坐标系"></a>坐标系</h3><ul><li>World space：包含所有物体的坐标系。</li><li>Model space：模型制作的时的坐标系。</li><li>Local space：当有其它物体相对于自身表示时的坐标系，骨骼的计算也是在这一坐标系中进行的。</li></ul><p><img   class="lazyload" data-original="/images/article/Games104/08/Games104_08_22.png" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==" ><span class="image-caption">坐标系</span></p><h3 id="生物骨骼"><a href="#生物骨骼" class="headerlink" title="生物骨骼"></a>生物骨骼</h3><p>动画师在设计骨骼时，根据需求通常会有一套标准的骨骼，在此基础上进行角色动画的制作。<br>这些骨骼由一系列的刚性joint组成，两个joint可以为一根骨骼（Bone）。所有的joint都附属于root节点，通常处于角色的底部。<br><img   class="lazyload" data-original="/images/article/Games104/08/Games104_08_23.png" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==" ><span class="image-caption">生物骨骼01</span><br><img   class="lazyload" data-original="/images/article/Games104/08/Games104_08_24.png" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==" ><span class="image-caption">生物骨骼02</span></p><h3 id="人物骨架"><a href="#人物骨架" class="headerlink" title="人物骨架"></a>人物骨架</h3><p>游戏中的人物，除了标准的骨骼，还会有许多附加的骨骼。比如穿着斗篷、拿着武器以及表情动画，都会有额外骨骼的需求。<br><img   class="lazyload" data-original="/images/article/Games104/08/Games104_08_25.png" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==" ><span class="image-caption">人物骨架</span></p><h3 id="对象的绑定动画"><a href="#对象的绑定动画" class="headerlink" title="对象的绑定动画"></a>对象的绑定动画</h3><p>游戏中常见一种动画就是骑乘，比如开车、骑马。骑乘状态下的角色会随着载具一起运动，那么两者之间就必须有一个连接点来保持两者的关系。<br><img   class="lazyload" data-original="/images/article/Games104/08/Games104_08_27.png" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==" ><span class="image-caption">对象的绑定动画</span></p><h3 id="T-Pos-A-Pos"><a href="#T-Pos-A-Pos" class="headerlink" title="T-Pos & A-Pos"></a>T-Pos &amp; A-Pos</h3><p>T-Pos与A-Pos是在制作人物骨骼动画时常见的两种pos。<br>T-Pos在处理肩部的有一定的肌肉挤压，会造成对这部分的骨骼权重精度不足。A-Pos更符合制作的需求。<br><img   class="lazyload" data-original="/images/article/Games104/08/Games104_08_26.png" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==" ><span class="image-caption">T-Pos &amp; A-Pos</span></p><h2 id="3D旋转的数学原理"><a href="#3D旋转的数学原理" class="headerlink" title="3D旋转的数学原理"></a>3D旋转的数学原理</h2><h3 id="欧拉角（Euler-Angle）"><a href="#欧拉角（Euler-Angle）" class="headerlink" title="欧拉角（Euler Angle）"></a>欧拉角（Euler Angle）</h3><p>可以通过绕xyz旋转的矩阵相乘来获取最终效果。<br>另一种表达欧拉角的方式是Yaw, Roll和Pitch，分别指水平的旋转、左右侧向高低变化以及抬头低头的变化。<br><img   class="lazyload" data-original="/images/article/Games104/08/Games104_08_28.png" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==" ><span class="image-caption">2D旋转矩阵</span><br><img   class="lazyload" data-original="/images/article/Games104/08/Games104_08_29.png" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==" ><span class="image-caption">3D欧拉角旋转矩阵</span></p><p>欧拉角存在的问题：</p><ul><li>顺序依赖，即换一种绕不同轴旋转的顺序会导致最终旋转结果不同。所以一般规定必须xyz顺序。</li><li>欧拉角存在“退化”问题，即当固定绕一个轴旋转时，其他两个轴就退化成同一个内容了，比如绕z轴转动时，x和y的地位就相同了，此时DoF实际上只有1度了。</li><li>插值困难。给定两组旋转角度时，很难计算它们之间的插值结果，不能简单线性插值。</li><li>很难绕其他任意特定轴旋转。</li></ul><p><img   class="lazyload" data-original="/images/article/Games104/08/Games104_08_31.png" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==" ><span class="image-caption">旋转插值</span><br><img   class="lazyload" data-original="/images/article/Games104/08/Games104_08_30.png" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==" ><span class="image-caption">欧拉角存在的问题</span></p><h3 id="四元数（Quaternion）"><a href="#四元数（Quaternion）" class="headerlink" title="四元数（Quaternion）"></a>四元数（Quaternion）</h3><p>出于上述缺点，实际游戏制作中不太用欧拉角，反而用Quaternion会比较多。<br>其基于利用复数解决二维旋转问题的方法。<br><img   class="lazyload" data-original="/images/article/Games104/08/Games104_08_32.png" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==" ><span class="image-caption">复数和二维旋转</span></p><p>进一步提升到三维空间后<br><img   class="lazyload" data-original="/images/article/Games104/08/Games104_08_33.png" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==" ><span class="image-caption">四元数向量运算基础</span><br>比较值得注意的是<br><mjx-container class="MathJax" jax="SVG" display="true"><svg style="vertical-align:-.462ex" xmlns="http://www.w3.org/2000/svg" width="23.706ex" height="2.461ex" role="img" focusable="false" viewBox="0 -883.9 10477.9 1087.9"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msup"><g data-mml-node="mi"><path data-c="1D456" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z"></path></g><g data-mml-node="mn" transform="translate(378,413) scale(0.707)"><path data-c="32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"></path></g></g><g data-mml-node="mo" transform="translate(1059.3,0)"><path data-c="3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"></path></g><g data-mml-node="msup" transform="translate(2115.1,0)"><g data-mml-node="mi"><path data-c="1D457" d="M297 596Q297 627 318 644T361 661Q378 661 389 651T403 623Q403 595 384 576T340 557Q322 557 310 567T297 596ZM288 376Q288 405 262 405Q240 405 220 393T185 362T161 325T144 293L137 279Q135 278 121 278H107Q101 284 101 286T105 299Q126 348 164 391T252 441Q253 441 260 441T272 442Q296 441 316 432Q341 418 354 401T367 348V332L318 133Q267 -67 264 -75Q246 -125 194 -164T75 -204Q25 -204 7 -183T-12 -137Q-12 -110 7 -91T53 -71Q70 -71 82 -81T95 -112Q95 -148 63 -167Q69 -168 77 -168Q111 -168 139 -140T182 -74L193 -32Q204 11 219 72T251 197T278 308T289 365Q289 372 288 376Z"></path></g><g data-mml-node="mn" transform="translate(445,413) scale(0.707)"><path data-c="32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"></path></g></g><g data-mml-node="mo" transform="translate(3241.4,0)"><path data-c="3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"></path></g><g data-mml-node="msup" transform="translate(4297.2,0)"><g data-mml-node="mi"><path data-c="1D458" d="M121 647Q121 657 125 670T137 683Q138 683 209 688T282 694Q294 694 294 686Q294 679 244 477Q194 279 194 272Q213 282 223 291Q247 309 292 354T362 415Q402 442 438 442Q468 442 485 423T503 369Q503 344 496 327T477 302T456 291T438 288Q418 288 406 299T394 328Q394 353 410 369T442 390L458 393Q446 405 434 405H430Q398 402 367 380T294 316T228 255Q230 254 243 252T267 246T293 238T320 224T342 206T359 180T365 147Q365 130 360 106T354 66Q354 26 381 26Q429 26 459 145Q461 153 479 153H483Q499 153 499 144Q499 139 496 130Q455 -11 378 -11Q333 -11 305 15T277 90Q277 108 280 121T283 145Q283 167 269 183T234 206T200 217T182 220H180Q168 178 159 139T145 81T136 44T129 20T122 7T111 -2Q98 -11 83 -11Q66 -11 57 -1T48 16Q48 26 85 176T158 471L195 616Q196 629 188 632T149 637H144Q134 637 131 637T124 640T121 647Z"></path></g><g data-mml-node="mn" transform="translate(554,413) scale(0.707)"><path data-c="32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"></path></g></g><g data-mml-node="mo" transform="translate(5532.5,0)"><path data-c="3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"></path></g><g data-mml-node="mi" transform="translate(6588.3,0)"><path data-c="1D456" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z"></path></g><g data-mml-node="mi" transform="translate(6933.3,0)"><path data-c="1D457" d="M297 596Q297 627 318 644T361 661Q378 661 389 651T403 623Q403 595 384 576T340 557Q322 557 310 567T297 596ZM288 376Q288 405 262 405Q240 405 220 393T185 362T161 325T144 293L137 279Q135 278 121 278H107Q101 284 101 286T105 299Q126 348 164 391T252 441Q253 441 260 441T272 442Q296 441 316 432Q341 418 354 401T367 348V332L318 133Q267 -67 264 -75Q246 -125 194 -164T75 -204Q25 -204 7 -183T-12 -137Q-12 -110 7 -91T53 -71Q70 -71 82 -81T95 -112Q95 -148 63 -167Q69 -168 77 -168Q111 -168 139 -140T182 -74L193 -32Q204 11 219 72T251 197T278 308T289 365Q289 372 288 376Z"></path></g><g data-mml-node="mi" transform="translate(7345.3,0)"><path data-c="1D458" d="M121 647Q121 657 125 670T137 683Q138 683 209 688T282 694Q294 694 294 686Q294 679 244 477Q194 279 194 272Q213 282 223 291Q247 309 292 354T362 415Q402 442 438 442Q468 442 485 423T503 369Q503 344 496 327T477 302T456 291T438 288Q418 288 406 299T394 328Q394 353 410 369T442 390L458 393Q446 405 434 405H430Q398 402 367 380T294 316T228 255Q230 254 243 252T267 246T293 238T320 224T342 206T359 180T365 147Q365 130 360 106T354 66Q354 26 381 26Q429 26 459 145Q461 153 479 153H483Q499 153 499 144Q499 139 496 130Q455 -11 378 -11Q333 -11 305 15T277 90Q277 108 280 121T283 145Q283 167 269 183T234 206T200 217T182 220H180Q168 178 159 139T145 81T136 44T129 20T122 7T111 -2Q98 -11 83 -11Q66 -11 57 -1T48 16Q48 26 85 176T158 471L195 616Q196 629 188 632T149 637H144Q134 637 131 637T124 640T121 647Z"></path></g><g data-mml-node="mo" transform="translate(8144.1,0)"><path data-c="3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"></path></g><g data-mml-node="mo" transform="translate(9199.9,0)"><path data-c="2212" d="M84 237T84 250T98 270H679Q694 262 694 250T679 230H98Q84 237 84 250Z"></path></g><g data-mml-node="mn" transform="translate(9977.9,0)"><path data-c="31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path></g></g></g></svg></mjx-container><br>这个式子，从中可以得出 ij = k, ik = j, jk = i 的事实。从而便于理解后面两个旋转的累积结果的矩阵。<br>与二维的复数一样，这个四元数也有共轭和互逆的概念。<br><img   class="lazyload" data-original="/images/article/Games104/08/Games104_08_34.png" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==" ><span class="image-caption">欧拉角转Quaternion</span></p><p><img   class="lazyload" data-original="/images/article/Games104/08/Games104_08_35.png" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==" ><span class="image-caption">Quaternion旋转</span></p><p>其中q是指旋转的四元数，v’ 是v进行q旋转后的结果<br>对上式进行计算优化后，结果可以表示为<br><img   class="lazyload" data-original="/images/article/Games104/08/Games104_08_36.png" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==" ><span class="image-caption">四元数到旋转矩阵</span></p><p>在以上基础上，利用四元数可以表示很多三维空间的旋转，包括反旋转、旋转的结合以及从当前方向u到指定方向v的旋转函数计算等<br><img   class="lazyload" data-original="/images/article/Games104/08/Games104_08_37.png" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==" ><span class="image-caption">四元数旋转数学</span></p><p>四元数还有一个应用就是围绕任意固定轴旋转，其中u就是那个指定轴的单位坐标，q就是与这个轴和旋转角度相关的一个旋转四元数，v’即v旋转后的结果。<br><img   class="lazyload" data-original="/images/article/Games104/08/Games104_08_38.png" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==" ><span class="image-caption">任意轴Quaternion旋转</span></p><h2 id="关节与蒙皮"><a href="#关节与蒙皮" class="headerlink" title="关节与蒙皮"></a>关节与蒙皮</h2><h3 id="Transform"><a href="#Transform" class="headerlink" title="Transform"></a>Transform</h3><p>关节的Pose有三个维度：Orientation、Position和Scale</p><h4 id="Orientation"><a href="#Orientation" class="headerlink" title="Orientation"></a>Orientation</h4><p><img   class="lazyload" data-original="/images/article/Games104/08/Games104_08_39.png" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==" ><span class="image-caption">方向</span></p><h4 id="Position"><a href="#Position" class="headerlink" title="Position"></a>Position</h4><p><img   class="lazyload" data-original="/images/article/Games104/08/Games104_08_40.png" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==" ><span class="image-caption">定位</span></p><h4 id="Scale"><a href="#Scale" class="headerlink" title="Scale"></a>Scale</h4><p><img   class="lazyload" data-original="/images/article/Games104/08/Games104_08_41.png" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==" ><span class="image-caption">比例</span></p><p>合并起来形成了Affine Matrix<br><img   class="lazyload" data-original="/images/article/Games104/08/Games104_08_42.png" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==" ><span class="image-caption">Transfrom矩阵</span></p><h3 id="骨骼动画-蒙皮"><a href="#骨骼动画-蒙皮" class="headerlink" title="骨骼动画 & 蒙皮"></a>骨骼动画 &amp; 蒙皮</h3><p>骨骼动画中所有的骨骼变动都是基于局部坐标系（旋转时能够保证骨骼大小不变），也就是和父节点相关。<br>所有骨骼的变动是逐步叠加的结果。骨骼动画需要存储model space下，关键帧root =&gt; joint的变换矩阵。<br><img   class="lazyload" data-original="/images/article/Games104/08/Games104_08_43.png" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==" ><span class="image-caption">从局部空间到模型空间</span></p><p>在处理骨骼蒙皮时，会记录皮肤Mesh顶点相对绑定骨骼的位置，这样皮肤就能跟随骨骼运动。<br>在处理骨骼蒙皮时，只需要知道Mesh顶点在model space的坐标和绑定矩阵，就可以知道蒙皮顶点相对Joint的局部坐标。<br><img   class="lazyload" data-original="/images/article/Games104/08/Games104_08_44.png" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==" ><span class="image-caption">蒙皮矩阵01</span><br><img   class="lazyload" data-original="/images/article/Games104/08/Games104_08_45.png" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==" ><span class="image-caption">蒙皮矩阵02</span></p><p>通常骨骼的数量很少，蒙皮顶点的数量很多，因此不可能每次计算蒙皮顶点时都计算骨骼的转化矩阵。在计算骨骼动画时，<br>先计算好某一时刻的骨骼动画，再计算所有的蒙皮矩阵。在计算实际的顶点时，是在世界空间下处理，因此可以将这部分骨骼矩阵计算好，再处理蒙皮效果。<br><img   class="lazyload" data-original="/images/article/Games104/08/Games104_08_46.png" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==" ><span class="image-caption">蒙皮矩阵调色板</span></p><h3 id="Clip插值"><a href="#Clip插值" class="headerlink" title="Clip插值"></a>Clip插值</h3><p>一个动画Clip是由一些关键帧组成的，关键帧之间由两个关键帧的数据插值计算，由此获得较为平滑的动作。<br>对弈简单的差值，比如位置就可以直接进行差值，但上面提到的角度差值就相对麻烦。<br><img   class="lazyload" data-original="/images/article/Games104/08/Games104_08_47.png" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==" ><span class="image-caption">简单插值</span></p><p>对于角度来说，最直观的线性插值（q1 -&gt; q2直线），但旋转需要保证半径不变，因此要对对线性插值结果标准化处理（NLERP）。<br>缺点：角度变化不均匀，中间慢，两边慢。<br><img   class="lazyload" data-original="/images/article/Games104/08/Games104_08_48.png" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==" ><span class="image-caption">旋转的四元数插值</span></p><p>最短路径插值：从一个角度移动到另一个角度，对于每个维度来说都有两种变化方式，而符合人直观的插值是最短路径插值。<br>通过四元数点乘的正负值；方向向量的叉乘正负值来处理旋转方向。<br><img   class="lazyload" data-original="/images/article/Games104/08/Games104_08_49.png" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==" ><span class="image-caption">最短路径插值</span></p><p>SLERP：先计算旋转角度，对角度进行差值计算位置。优点：变化均匀。<br>缺点：计算量略高（反三角函数）；旋转角度很小时，计算结果不稳定。<br><img   class="lazyload" data-original="/images/article/Games104/08/Games104_08_50.png" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==" ><span class="image-caption">SLERP</span></p><p>混合处理：设定一个角度阈值，当夹角小于阈值时，使用NLERP;当角度大于阈值时，使用SLERP。<br><img   class="lazyload" data-original="/images/article/Games104/08/Games104_08_51.png" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==" ><span class="image-caption">NLERP VS SLERP</span></p><h3 id="动画管线"><a href="#动画管线" class="headerlink" title="动画管线"></a>动画管线</h3><p>基础动画管线：根据时间插值计算当前帧的Pos =&gt; 计算蒙皮Mesh =&gt; GPU渲染。<br>现代动画管线：大部分CPU计算放到GPU处理。<br><img   class="lazyload" data-original="/images/article/Games104/08/Games104_08_52.png" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==" ><span class="image-caption">基础动画管线</span></p><h2 id="动画技术压缩"><a href="#动画技术压缩" class="headerlink" title="动画技术压缩"></a>动画技术压缩</h2><p>动画需要处理的数据很多，会占用大量的存储空间，若不就行压缩处理，难以在硬件设备上运行。<br><img   class="lazyload" data-original="/images/article/Games104/08/Games104_08_53.png" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==" ><span class="image-caption">动画数据大小</span></p><h3 id="简单压缩"><a href="#简单压缩" class="headerlink" title="简单压缩"></a>简单压缩</h3><p>如果存下所有节点每秒比如三十帧的数据，会导致数据量过大没法使用，所以必须进行压缩。<br>第一步是进行DoF的压缩，我们可以发现，对大部分节点来说，其scale不怎么变化，所以可以直接去掉（除了脸部节点）；<br>同时，节点的translate也不怎么动，只需要存储固定值（除了骨盆和脸部节点）。<br><img   class="lazyload" data-original="/images/article/Games104/08/Games104_08_54.png" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==" ><span class="image-caption">自由度降低</span></p><h3 id="关键帧与插值曲线"><a href="#关键帧与插值曲线" class="headerlink" title="关键帧与插值曲线"></a>关键帧与插值曲线</h3><p>针对旋转，比较简单的方法是使用关键帧Key Frame进行插值，当插值误差小于一定阈值时就设为关键帧，<br>不然就把这插值对应的GT帧加入关键帧再继续细分。因而关键帧的间隔不是固定的。<br><img   class="lazyload" data-original="/images/article/Games104/08/Games104_08_55.png" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==" ><span class="image-caption">关键帧</span></p><p>关键帧的结果虽然不错，但仍然是一条折线。所以又提出了Catmull-Rom Spline：在两帧P1P2之外分别再取P0P3，然后拟合这个曲线即可。<br><img   class="lazyload" data-original="/images/article/Games104/08/Games104_08_56.png" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==" ><span class="image-caption">Catmull-Rom Spline</span></p><h3 id="数值精度"><a href="#数值精度" class="headerlink" title="数值精度"></a>数值精度</h3><p><img   class="lazyload" data-original="/images/article/Games104/08/Games104_08_57.png" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==" ><span class="image-caption">浮点量化</span><br>对已知范围的浮点数映射到0~1之间，可以增加数据的精度。对于四元数可利用归一化的特性，只存储三个绝对值较小的数据，这三个值处于一定范围内。<br>这样只需要2bit存储最大值的位置，其余每位15bit，共48bit。<br><img   class="lazyload" data-original="/images/article/Games104/08/Games104_08_58.png" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==" ><span class="image-caption">四元数量化01</span><br><img   class="lazyload" data-original="/images/article/Games104/08/Games104_08_59.png" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==" ><span class="image-caption">四元数量化02</span></p><h3 id="Error"><a href="#Error" class="headerlink" title="Error"></a>Error</h3><p>压缩虽然好用，但会带来误差累积问题。所以需要检测误差是不是被控制在可接受范围内。<br>最实际可用的误差是visual error视觉误差，但如果对比压缩前后每顶点的误差则计算量太大，所以实际中针对每一个节点joint进行估计：<br>对节点估计两个互相垂直方向上的点，距离设置为offset（如果精度敏感则offset大一点，如果不敏感或小骨骼的话就offset小一点），<br>这样只需要比较两个点在压缩前后的error即可<br><img   class="lazyload" data-original="/images/article/Games104/08/Games104_08_60.png" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==" ><span class="image-caption">误差传播</span></p><p>Error Compensation：在多帧误差累积后反向进行偏移来补偿。其问题就是这一帧和上一帧会很不连贯。<br><img   class="lazyload" data-original="/images/article/Games104/08/Games104_08_61.png" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==" ><span class="image-caption">偏移补偿</span></p><h2 id="动画技术流程"><a href="#动画技术流程" class="headerlink" title="动画技术流程"></a>动画技术流程</h2><h3 id="Mesh-building"><a href="#Mesh-building" class="headerlink" title="Mesh building"></a>Mesh building</h3><p><img   class="lazyload" data-original="/images/article/Games104/08/Games104_08_62.png" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==" ><span class="image-caption">网状结构</span></p><h3 id="Skeleton-Binding"><a href="#Skeleton-Binding" class="headerlink" title="Skeleton Binding"></a>Skeleton Binding</h3><p>DCC软件通常自带预制骨架，美术可以手动将骨骼附加到指定到Mesh位置。<br><img   class="lazyload" data-original="/images/article/Games104/08/Games104_08_64.png" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==" ><span class="image-caption">骨架图</span></p><h3 id="Skinning"><a href="#Skinning" class="headerlink" title="Skinning"></a>Skinning</h3><p><img   class="lazyload" data-original="/images/article/Games104/08/Games104_08_63.png" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==" ><span class="image-caption">蒙皮</span></p><h3 id="Animation-Creation"><a href="#Animation-Creation" class="headerlink" title="Animation Creation"></a>Animation Creation</h3><p><img   class="lazyload" data-original="/images/article/Games104/08/Games104_08_65.png" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==" ><span class="image-caption">动画创作</span></p><h3 id="Exporting"><a href="#Exporting" class="headerlink" title="Exporting"></a>Exporting</h3><p>在DCC软件中完成动画资源制作后，需要将资源导出到游戏引擎中使用。这其中就有许多细节又要注意：</p><ul><li>尺寸单位一致性</li><li>坐标系一致性</li><li>是否附带位移曲线</li></ul><p><img   class="lazyload" data-original="/images/article/Games104/08/Games104_08_66.png" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==" ><span class="image-caption">导出</span></p><h2 id="引用"><a href="#引用" class="headerlink" title="引用"></a>引用</h2><p><a target="_blank" rel="noopener external nofollow noreferrer" href="https://zhuanlan.zhihu.com/p/537220623">参考文章1</a></p><p><a target="_blank" rel="noopener external nofollow noreferrer" href="https://blog.csdn.net/Jason__Y/article/details/124731287">参考文章2</a></p><p><a target="_blank" rel="noopener external nofollow noreferrer" href="https://www.bilibili.com/video/BV1jr4y1t7WR/?spm_id_from=333.788&vd_source=371bc0e94a8c97f991c4ac20af0b2d53">课程视频1</a></p><p><a target="_blank" rel="noopener external nofollow noreferrer" href="https://www.bilibili.com/video/BV1fF411j7hA/?spm_id_from=333.788&vd_source=371bc0e94a8c97f991c4ac20af0b2d53">课程视频2</a></p><p><a target="_blank" rel="noopener external nofollow noreferrer" href="https://cdn.boomingtech.com/games104_static/upload/GAMES104_Lecture%2008_Animation%20System%20-%20Basics%20of%20Animation%20Technology.pdf">课件PPT</a></p></section><section class="extra"><ul class="copyright"><li><strong>本文作者：</strong>樱白 - Cherry White</li><li><strong>本文链接：</strong><a href="https://cherry-white.github.io/posts/b1eb3151.html" title="https:&#x2F;&#x2F;cherry-white.github.io&#x2F;posts&#x2F;b1eb3151.html">https:&#x2F;&#x2F;cherry-white.github.io&#x2F;posts&#x2F;b1eb3151.html</a></li><li><strong>版权声明：</strong>本博客所有文章均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" title="BY-NC-SA" target="_blank" rel="noopener external nofollow noreferrer">BY-NC-SA</a> 许可协议，转载请注明出处！</li></ul><section class="donate"><div id="qrcode-donate"><img   class="lazyload" data-original="/images/pay/alipay.png" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==" ></div><div class="icon"><a href="javascript:;" rel="external nofollow noreferrer" id="alipay"><i class="iconfont iconalipay"></i></a> <a href="javascript:;" rel="external nofollow noreferrer" id="wechat"><i class="iconfont iconwechat-fill"></i></a></div></section><ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/games104/" rel="tag">games104</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%B8%B8%E6%88%8F%E5%BC%95%E6%93%8E/" rel="tag">游戏引擎</a></li></ul><nav class="nav"><a href="/posts/649819f1.html"><i class="iconfont iconleft"></i>现代游戏引擎 - 高级动画技术：动画树、IK和表情动画（九）</a> <a href="/posts/ed8f511c.html">现代游戏引擎 - 游戏中渲染管线、后处理和其他的一切（七）<i class="iconfont iconright"></i></a></nav></section><section class="comments"><div class="btn" id="comments-btn">查看评论</div><link rel="stylesheet" href="/lib/gitalk/gitalk.css"><div id="gitalk" class="gitalk"></div><script src="/lib/gitalk/gitalk.js"></script><script>const title=window.location.pathname.substring(0,50);window.onload=function(){const e=new Gitalk({clientID:"5d2553717eea46759e10",clientSecret:"4d93ce39e65dd2c5b9e364f75d06efd73c64a8ba",id:title,repo:"cherry-white.github.io",owner:"cherry-white",admin:"cherry-white",proxy:"https://vercel.prohibitorum.top/github_access_token"});$("#comments-btn").on("click",function(){$(this).hide(),e.render("gitalk")})}</script></section></section></div></article></div><div class="col-xl-3"><aside class="toc-wrap"><h3 class="toc-title">文章目录：</h3><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8A%A8%E7%94%BB%E6%8A%80%E6%9C%AF%E7%AE%80%E4%BB%8B"><span class="toc-text">动画技术简介</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%94%B5%E5%BD%B1%E4%B8%AD%E7%9A%84%E5%8A%A8%E7%94%BB%E6%8A%80%E6%9C%AF%E5%8F%91%E5%B1%95"><span class="toc-text">电影中的动画技术发展</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B8%B8%E6%88%8F%E4%B8%AD%E7%9A%84%E5%8A%A8%E7%94%BB%E6%8A%80%E6%9C%AF%E5%8F%91%E5%B1%95"><span class="toc-text">游戏中的动画技术发展</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B8%B8%E6%88%8F%E5%8A%A8%E7%94%BB%E6%8C%91%E6%88%98"><span class="toc-text">游戏动画挑战</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2D%E6%B8%B8%E6%88%8F%E5%8A%A8%E7%94%BB%E6%8A%80%E6%9C%AF"><span class="toc-text">2D游戏动画技术</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3D%E6%B8%B8%E6%88%8F%E5%8A%A8%E7%94%BB%E6%8A%80%E6%9C%AF"><span class="toc-text">3D游戏动画技术</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%87%AA%E7%94%B1%E5%BA%A6"><span class="toc-text">自由度</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%9A%E6%80%A7%E5%B1%82%E6%AC%A1%E5%8A%A8%E7%94%BB"><span class="toc-text">刚性层次动画</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A1%B6%E7%82%B9%E5%8A%A8%E7%94%BB"><span class="toc-text">顶点动画</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Morph-Target-Animation"><span class="toc-text">Morph Target Animation</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2D-3D-%E8%92%99%E7%9A%AE%E5%8A%A8%E7%94%BB"><span class="toc-text">2D &amp; 3D 蒙皮动画</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Physics-based-Animation"><span class="toc-text">Physics-based Animation</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Animation-Content-Creation"><span class="toc-text">Animation Content Creation</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%92%99%E7%9A%AE%E5%8A%A8%E7%94%BB%E5%AE%9E%E7%8E%B0"><span class="toc-text">蒙皮动画实现</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Mesh%E5%A6%82%E4%BD%95%E8%BF%90%E5%8A%A8"><span class="toc-text">Mesh如何运动</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9D%90%E6%A0%87%E7%B3%BB"><span class="toc-text">坐标系</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%94%9F%E7%89%A9%E9%AA%A8%E9%AA%BC"><span class="toc-text">生物骨骼</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BA%BA%E7%89%A9%E9%AA%A8%E6%9E%B6"><span class="toc-text">人物骨架</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AF%B9%E8%B1%A1%E7%9A%84%E7%BB%91%E5%AE%9A%E5%8A%A8%E7%94%BB"><span class="toc-text">对象的绑定动画</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#T-Pos-A-Pos"><span class="toc-text">T-Pos &amp; A-Pos</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3D%E6%97%8B%E8%BD%AC%E7%9A%84%E6%95%B0%E5%AD%A6%E5%8E%9F%E7%90%86"><span class="toc-text">3D旋转的数学原理</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%AC%A7%E6%8B%89%E8%A7%92%EF%BC%88Euler-Angle%EF%BC%89"><span class="toc-text">欧拉角（Euler Angle）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9B%9B%E5%85%83%E6%95%B0%EF%BC%88Quaternion%EF%BC%89"><span class="toc-text">四元数（Quaternion）</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%85%B3%E8%8A%82%E4%B8%8E%E8%92%99%E7%9A%AE"><span class="toc-text">关节与蒙皮</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Transform"><span class="toc-text">Transform</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%AA%A8%E9%AA%BC%E5%8A%A8%E7%94%BB-%E8%92%99%E7%9A%AE"><span class="toc-text">骨骼动画 &amp; 蒙皮</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Clip%E6%8F%92%E5%80%BC"><span class="toc-text">Clip插值</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8A%A8%E7%94%BB%E7%AE%A1%E7%BA%BF"><span class="toc-text">动画管线</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8A%A8%E7%94%BB%E6%8A%80%E6%9C%AF%E5%8E%8B%E7%BC%A9"><span class="toc-text">动画技术压缩</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AE%80%E5%8D%95%E5%8E%8B%E7%BC%A9"><span class="toc-text">简单压缩</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%85%B3%E9%94%AE%E5%B8%A7%E4%B8%8E%E6%8F%92%E5%80%BC%E6%9B%B2%E7%BA%BF"><span class="toc-text">关键帧与插值曲线</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%95%B0%E5%80%BC%E7%B2%BE%E5%BA%A6"><span class="toc-text">数值精度</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Error"><span class="toc-text">Error</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8A%A8%E7%94%BB%E6%8A%80%E6%9C%AF%E6%B5%81%E7%A8%8B"><span class="toc-text">动画技术流程</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Mesh-building"><span class="toc-text">Mesh building</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Skeleton-Binding"><span class="toc-text">Skeleton Binding</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Skinning"><span class="toc-text">Skinning</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Animation-Creation"><span class="toc-text">Animation Creation</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Exporting"><span class="toc-text">Exporting</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%BC%95%E7%94%A8"><span class="toc-text">引用</span></a></li></ol></aside></div></div></div></main><footer class="footer"><div class="footer-social"><a href="tencent://message/?Menu=yes&uin=1789139001" target="_blank" class="footer-social-item" onmouseover='this.style.color="#12B7F5"' onmouseout='this.style.color="#33333D"'><i class="iconfont iconQQ"></i> </a><a href="/images/contact/wechat.jpg" target="_blank" class="footer-social-item" onmouseover='this.style.color="#09BB07"' onmouseout='this.style.color="#33333D"'><i class="iconfont iconwechat-fill"></i> </a><a href="https://cherry-white.github.io/" target="_blank" class="footer-social-item" onmouseover='this.style.color="#DA2E76"' onmouseout='this.style.color="#33333D"'><i class="iconfont iconinstagram"></i> </a><a href="https://gitee.com/zj1789139001" target="_blank" class="footer-social-item" onmouseover='this.style.color="#9f7be1"' onmouseout='this.style.color="#33333D"'><i class="iconfont icongithub-fill"></i> </a><a href="mailto:1789139001@qq.com" target="_blank" class="footer-social-item" onmouseover="this.style.color=#FF3B00" onmouseout='this.style.color="#33333D"'><i class="iconfont iconmail"></i></a></div><div class="footer-copyright"><p>Powered by <a target="_blank" href="https://hexo.io" rel="external nofollow noreferrer">Hexo</a> | Theme - <a target="_blank" href="https://github.com/izhaoo/hexo-theme-zhaoo" rel="external nofollow noreferrer">zhaoo</a></p><p>Cherry White .All Rights Reserved Copyright © 2021</p></div></footer><div class="fab fab-plus"><i class="iconfont iconplus"></i></div><a href="https://support.qq.com/product/368715" rel="external nofollow noreferrer" target="_blank"><div class="fab fab-tencent-chao"><i class="iconfont iconcomment"></i></div></a><div class="fab fab-up"><i class="iconfont iconcaret-up"></i></div><script src="/js/color-mode.js"></script><div class="search"><div class="search-container"><div class="search-close"><i class="iconfont iconbaseline-close-px"></i></div><div class="search-input-wrapper"><i class="search-input-icon iconfont iconsearch"></i> <input class="search-input" type="search" id="search-input" placeholder="Search..." autofocus autocomplete="off" autocorrect="off" autocapitalize="off"></div><div class="search-output" id="search-output"></div></div></div></body><script src="/lib/jquery/jquery.js"></script><script src="/lib/lazyload/lazyload.js"></script><script src="/lib/fancybox/fancybox.js"></script><script src="/lib/qrcode/qrcode.js"></script><script src="/js/utils.js"></script><script src="/js/script.js"></script><script>!function(){var t=document.createElement("script"),e=window.location.protocol.split(":")[0],e=(t.src="https"===e?"https://zz.bdstatic.com/linksubmit/push.js":"http://push.zhanzhang.baidu.com/push.js",document.getElementsByTagName("script")[0]);e.parentNode.insertBefore(t,e)}()</script><script defer src="https://hm.baidu.com/hm.js?3cbbee458915615f7e2e5b7a073f2113"></script><script src="https://fastly.jsdelivr.net/gh/stevenjoezhang/live2d-widget@latest/autoload.js"></script><script src="/random.js"></script></html>